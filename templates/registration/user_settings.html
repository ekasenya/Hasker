{% extends "base_generic.html" %}

{% block content %}

<h1>Setting</h1>
<form  method="post" enctype="multipart/form-data">
    {% csrf_token %}
  <div class="form-group row">
    <label for="login" class="col-sm-2 col-form-label">Login</label>
    <div class="col-sm-10">
      <input type="text" class="form-control-plaintext" id="login" value="{{ user.username }}">
    </div>
  </div>
  <div class="form-group row">
    <label for="user_email" class="col-sm-2 col-form-label">Email</label>
    <div class="col-sm-10">
      <input type="email" class="form-control" id="user_email" name="email" value="{{ user.email }}">
    </div>
  </div>
    <div class="form-group row">
        <label for="avatar" class="col-sm-2 col-form-label">Avatar</label>
        <div class="col-sm-10">
            <img src="{% if user.userprofile.avatar %} {{ user.userprofile.avatar.url }} {% endif %}" id="img-preview" width="100" height="100" alt="No image">

            <div class="custom-file">
              <input type="file" class="custom-file-input" id="avatar" name="avatar" accept="image/*"  onchange="loadFile(event)">
              <label class="custom-file-label" for="avatar" id="file_name" data-browse="Upload">{{ file_name|default_if_none:'Select file...' }}</label>
            </div>
        </div>
    </div>

  <div class="form-group row">
    <div class="col-sm-10">
        <button type="submit" class="btn btn-primary"  value="Update">Save</button>
        <input type="hidden" name="next" value="{{ next }}">
    </div>
  </div>
</form>
</form>

<script>
  var loadFile = function(event) {
    var preview = document.getElementById('img-preview');

    if (event.target.files.length > 0) {
        preview.src = URL.createObjectURL(event.target.files[0]);
        preview.onload = function() {
          URL.revokeObjectURL(preview.src)
        }
        document.getElementById('file_name').innerHTML = event.target.files[0].name
    }
  };
</script>
{% endblock %}